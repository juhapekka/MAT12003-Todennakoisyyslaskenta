\documentclass[12pt,a4paper]{article}
%\documentclass{article}
\input{yhteiset-asetukset.tex}

\title{MAT12003 Todennäköisyyslaskenta I — Viikko 1}
\date{}

\begin{document}

\maketitle

\exercise{1}
Luvuista \textbf{S = \{1, 2, \ldots, 100\}} valitaan umpimähkään yksi. Millä todennäköisyydellä valittu luku on:

\begin{kohta}
    \item \textbf{jaollinen luvulla 13}
    
    Määritellään $A = \{x \in S \mid x \bmod 13 = 0\}$\\
    Eli
    \[
    A = \{13, 26, 39, 52, 65, 78, 91\}, \quad |A| = 7 \text{ ja } |S| = 100
    \]
    \[
    P(A) = \frac{|A|}{|S|} = \frac{7}{100}
    \]

    \item \textbf{kaksinumeroinen, mutta ei jaollinen yhdellätoista} \\
    Määritellään
    \begin{align*}
        B &= \{x \in S \mid 10 \le x \le 99\} \\
        C &= \{x \in B \mid x \bmod 11 = 0\}
    \end{align*}
    \[
    \Rightarrow |B| = 90, \quad C = \{11, 22, \ldots, 99\},\quad |C| = 9
    \]
    Halutaan todennäköisyys, että luku kuuluu $B \setminus C$:
    \[
    P(B \setminus C) = \frac{|B \setminus C|}{|S|} = \frac{90 - 9}{100} = \frac{81}{100}
    \]

    \item \textbf{alkuluku?}

    Määritellään $P = \{x \in S \mid x \text{ on alkuluku}\}$.
    \[
    P = \{2,\ 3,\ 5,\ 7,\ 11,\ 13,\ 17,\ 19,\ 23,\ 29,\ 31,\ 37,\ 41,\ 43,\ 47,\ 53,\ 59,\ 61,\ 67,\ 71,\ 73,\ 79,\ 83,\ 89,\ 97\}
    \]
    \[
    |P| = 25 \quad \Rightarrow \quad P(\text{alkuluku}) = \frac{25}{100} = \frac{1}{4}
    \]
\end{kohta}









\newpage
\exercise{2}

Olkoot A ja B tapahtumia.

\begin{kohta}
  \item \textbf{Lausu joukko-operaatioiden avulla seuraavat tapahtumat: Tapahtumista A ja B}

  \begin{alakohta}
    \item \textbf{sattuu molemmat:}
    
    \[
    A \cap B
    \]

    \item \textbf{ei satu kumpikaan:}
    
    \[
    (A \cup B)^c
    \]

    \item \textbf{sattuu ainakin yksi:}
    
    \[
    A \cup B
    \]

    \item \textbf{sattuu täsmälleen yksi:}
    
    \[
    (A \cup B) \setminus (A \cap B)
    \]
  \end{alakohta}

  \item \textbf{Lausu näiden komplementtitapahtumat sanallisesti.}

  \begin{alakohta}
    \item Molempien tapahtuminen: komplementti on \textbf{"ei tapahdu molemmat"}
    eli tapahtuu korkeintaan toinen tai ei kumpikaan.

    \item Ei kumpikaan: komplementti on \textbf{"ainakin toinen tapahtuu"}.

    \item Ainakin yksi: komplementti on \textbf{"ei tapahdu kumpikaan"}.

    \item Täsmälleen yksi: komplementti on \textbf{"tapahtuu molemmat tai ei kumpikaan"}.
  \end{alakohta}
\end{kohta}










\newpage
\exercise{3}

Kuinka moni joukon $\{1,2,\ldots,20\}$ 4-alkioisista osajoukoista sisältää ainakin jonkin alkion joukosta $\{1, 2, 3, 4, 5\}$?\\

kirjoitetaan:

\begin{kuvaus}
  \item $S$ = $\{1,2,\ldots,20\}$, koko joukko, $|S| = 20$
  \item $A$ = $\{1, 2, 3, 4, 5\}$, joukko kiinnostavia alkioita, $|A| = 5$
  \item $B$ joukon $S$ ne alkiot, jotka \emph{eivät} ole joukossa
  $A$: $B = S \setminus A$, jolloin $|B| = 15$
\end{kuvaus}

Kaikkia nelialkioisia osajoukkoja on:

\[
\binom{20}{4}
\]
\\
Niistä ne, jotka eivät sisällä yhtään alkiota joukosta A,
ovat ne, jotka valitaan pelkästään joukosta B:

\[
\binom{15}{4}
\]
\\
Joten ne osajoukot, jotka sisältävät ainakin jonkin alkion joukosta
A, saadaan vähennyslaskulla:

\[
\binom{20}{4} - \binom{15}{4} = 4845 - 1365 = 3480
\]
\\
Eli, joukon $\{1,2,\ldots,20\}$ 4-alkioisista osajoukoista \textbf{3480} sisältää ainakin jonkin alkion joukosta $\{1, 2, 3, 4, 5\}$








\newpage
\exercise{4}

Muodostetaan kirjaimista A--Z kolmekirjaiminen sana. Kuinka monessa sanassa kirjaimet ovat aakkosjärjestyksessä? (Kirjaimet ovat aakkosjärjestyksessä esimerkiksi sanoissa AKT ja BBC. Sanan ei siis tarvitse tarkoittaa mitään ja sama kirjain voi esiintyä useamman kerran.)

\vspace{0.4cm}

Merkitään kirjaimia numeroilla $x_1, x_2, x_3$, missä $x_i \in \{1, 2, \ldots, 26\}$.
Koska kirjainten tulee olla aakkosjärjestyksessä ja samat kirjaimat on sallittuja on voimassa ehto:
\[
1 \le x_1 \le x_2 \le x_3 \le 26
\]

Muunentaan tämä kombinaatioksi ilman toistoja seuraalla muunnoksella:
\begin{align*}
y_1 &= x_1 \\
y_2 &= x_2 + 1 \\
y_3 &= x_3 + 2
\end{align*}
alkuperäinen epäyhtälöketju $x_1 \le x_2 \le x_3$ muuttuu aidosti kasvavaksi epäyhtälöketjuksi $y_1 < y_2 < y_3$\\

Määritetään uusien muuttujien $y_i$ arvoalue:
\begin{itemize}
    \item Pienin mahdollinen arvo on $y_1 = x_1 = 1$.
    \item Suurin mahdollinen arvo saadaan, kun $x_3=26$, jolloin $y_3 = 26 + 2 = 28$.
\end{itemize}
\vspace{0.4cm}

\korostus{Tehtävä on siis nyt muodossa: "Kuinka monta tapaa on valita kolme eri lukua joukosta $\{1, 2, \ldots, 28\}?"$}\\

Päästään peruskombinaatiomuotoon missä valitaan 3 alkiota 28:sta:
\[
\binom{28}{3}
\]
\\
\[
\Rightarrow \binom{28}{3} = \frac{28!}{3!(28-3)!} = \frac{28 \cdot 27 \cdot 26}{3 \cdot 2 \cdot 1} = \frac{19656}{6} = 3276
\]
\vspace{0.5cm}
Siis, on olemassa \textbf{3276} erilaista kolmekirjaimista sanaa, joissa kirjaimet ovat aakkosjärjestyksessä.









\newpage
\exercise{5}

$n$ henkilön joukosta valitaan $k$-henkinen komitea,
jossa yksi henkilöistä on puheenjohtajana ($1\leq k\leq n$). 
Montako eri komiteaa voidaan
muodostaa, kun tulkitaan eri komiteoiksi myös ne, joissa on samat
jäsenet, mutta eri puheenjohtaja? Laske lukumäärä valitsemalla
\begin{enumerate}
\item[(a)] ensin komitea ja sitten puheenjohtaja, 
\item[(b)] ensin puheenjohtaja ja sitten muut jäsenet,
\end{enumerate} 
ja näytä, että tulokset ovat samat.

\vspace{0.4cm}


\begin{kohta}
  \item \textbf{ensin komitea ja sitten puheenjohtaja,}

\begin{alakohta}
    \item \textbf{Valitaan k-henkinen komitea.} \\
    Joukosta, jossa on n henkilöä, valitaan k jäsentä. Mahdollisia komiteoita on:
    \[
    \binom{n}{k} \text{ kpl}
    \]

    \item \textbf{Valitaan puheenjohtaja komitean jäsenistä.} \\
    Valitussa komiteassa on k jäsentä ja kuka tahansa heistä voidaan valita puheenjohtajaksi. mahdollisuuksia puheenjohtajaksi on siis k kappaletta.
\end{alakohta}

Kokonaislukumäärä saadaan kertomalla mahdollisuudet keskenään:
\[
\text{Tapoja yhteensä} = \binom{n}{k} \cdot k
\]


% -----------
\item \textbf{ensin puheenjohtaja ja sitten muut jäsenet,}\\
Lasketaan sama asia, mutta eri järjestysessä.

\begin{alakohta}
    \item \textbf{Valitaan puheenjohtaja koko joukosta.} \\
    Joukossa on n henkilöä, joista kuka tahansa voidaan valita puheenjohtajaksi.
    Mahdollisuuksia puheenjohtajia on siis n kappaletta.
    
    \item \textbf{Valitaan loput k-1 jäsentä.} \\
    Kun puheenjohtaja on valittu, jäljelle jää n-1 henkilöä. Näistä henkilöistä
    valiaan komitean loput k-1 jäsentä. Mahdollisuuksia tähän on:
    \[
    \binom{n-1}{k-1} \text{ kpl}
    \]
\end{alakohta}

Kokonaislukumäärä on:
\[
\text{Tapoja yhteensä} = n \cdot \binom{n-1}{k-1}
\]
\pagebreak


\subsection*{Osoitus: Tulos on sama}
Jos molemmat laskentatavat kuvaavat samaa tilannetta, niiden on tuotettava sama tulos.

Tavoite on siis näyttää että $\displaystyle \binom{n}{k} \cdot k = n \cdot \binom{n-1}{k-1}$.

Tarkastellaan lausekkeen vasenta puolta
\begin{align*}
\text{vasen} &= \binom{n}{k} \cdot k \\
&= \frac{n!}{k!(n-k)!} \cdot k \\
&= \frac{n! \cdot k}{k \cdot (k-1)!(n-k)!} \\
&= \frac{n!}{(k-1)!(n-k)!}
\end{align*}

Tarkastellaan sitten oikeaa puolta
\begin{align*}
\text{oikea} &= n \cdot \binom{n-1}{k-1} \\
&= n \cdot \frac{(n-1)!}{(k-1)!((n-1)-(k-1))!} \\
&= n \cdot \frac{(n-1)!}{(k-1)!(n-k)!} \\
&= \frac{n \cdot (n-1)!}{(k-1)!(n-k)!} \\
&= \frac{n!}{(k-1)!(n-k)!}
\end{align*}

Koska vasen = oikea tulokset ovat samat.
\end{kohta}









\newpage
\exercise{6}

Tavallisesta 52 pelikortin pakasta nostetaan 7 korttia. Millä todennäköisyydellä
\begin{enumerate}
\item[(a)] joukossa on vähintään yksi pata,
\item[(b)] punaisia kortteja on ainakin kaksi enemmän kuin mustia,
\item[(c)] joukossa on neljä samanarvoista korttia?
\end{enumerate}

\begin{kohta}
  \item \textbf{joukossa on vähintään yksi pata,}

  Lasketaan ensin kaikkien 7 kortin yhdistelmien määrä:
  \[
  \binom{52}{7}
  \]

  Sen jälkeen ne jaot ilman yhtään pataa.
  Patoja on 13, joten ei-patoja on 52 - 13 = 39

  Ei-patoja sisältäviä 7-kortin jakoja on:
  \[
  \binom{39}{7}
  \]

  Vähintään yksi pata = kaikki mahdolliset jaot – jaot joissa ei ole pataa:
  \[
  P(\text{vähintään yksi pata}) = 1 - \frac{\binom{39}{7}}{\binom{52}{7}}
  \]

  Pythonilla:
    \begin{verbatim}
      >>> import math
      >>> print(1 - (math.comb(39, 7) / math.comb(52, 7)))
      0.8850320470463856
    \end{verbatim}

    Eli joukossa vähintään yksi pata $\approx 0.89$ todennälöisyydellä.

\begin{comment}
  
\begin{alakohta}
    \item \textbf{Tapahtuma ja sen komplementti:} \\
    A: Kädessä on vähintään yksi pata \\
    Komplementti $A^c$: Käsi missä ei ole yhtään pataa

    \item \textbf{Lasketaan komplementti tapaukset:} \\
    Pakassa on 13 pataa ja $52 - 13 = 39$ muuta korttia. Jotta kädessä ei ole
    yhtään pataa, kaikki 7 korttia on valitaan näistä 39 kortista.
    \[
    \text{Kädet ilman pataa} = \binom{39}{7} = 15380937
    \]

    \item \textbf{Lasketaan todennäköisyys:} \\
    Komplementti tapauksen todennäköisyys on:
    \[
    P(A^c) = \frac{\binom{39}{7}}{\binom{52}{7}}
    \]
    Alkuperäisen tapauksen todennäköisyys on $P(A) = 1 - P(A^c)$.
    \[
    P(\text{vähintään yksi pata}) = 1 - \frac{\binom{39}{7}}{\binom{52}{7}} \approx 1 - 0.114968 = 0.885032
    \]
\end{alakohta}

\textbf{Vastaus (a):} Todennäköisyys on $1 - \frac{\binom{39}{7}}{\binom{52}{7}} \approx 88.5\%$.

\end{comment}




\pagebreak
  \item \textbf{punaisia kortteja on ainakin kaksi enemmän kuin mustia,}
\begin{comment}
  
  \textbf{Ratkaisu:}

  Punaisia kortteja on 26 (hertta + ruutu), mustia 26 (risti + pata).  
  Nostetaan 7 korttia, ja halutaan:

  \[
  \text{Punaiset} - \text{Mustat} \ge 2
  \quad \Leftrightarrow \quad
  \text{Punaiset} \ge \left\lceil \frac{7 + 2}{2} \right\rceil = 5
  \]

  Eli punaisia kortteja oltava vähintään 5. Käydään läpi kaikki tapaukset:
  \begin{alakohta}
    \item 5 punaista, 2 mustaa
    \item 6 punaista, 1 musta
    \item 7 punaista, 0 mustaa
  \end{alakohta}

  Jokaisessa tapauksessa valitaan ensin punaiset ja sitten mustat:
  \[
  \sum_{r=5}^{7} \binom{26}{r} \cdot \binom{26}{7 - r}
  \]

  Kokonaismäärä on $\binom{52}{7}$, joten todennäköisyys:
  \[
  P = \frac{1}{\binom{52}{7}} \sum_{r=5}^{7} \binom{26}{r} \cdot \binom{26}{7 - r}
  \]

  \textbf{Vastaus:} \(\dfrac{\sum_{r=5}^{7} \binom{26}{r} \cdot \binom{26}{7 - r}}{\binom{52}{7}}\)
\end{comment}

Pakassa on 26 punaista ja 26 mustaa korttia. Nostetaan 7 korttia. Olkoon p punaisten ja m mustien korttien lukumäärä kädessä.
Ehto on $p \ge m + 2$. Koska $p+m=7$, voimme ratkaista mahdolliset parit $(p, m)$:
\begin{itemize}
    \item Jos $p=7, m=0 \implies 7 \ge 0+2$
    \item Jos $p=6, m=1 \implies 6 \ge 1+2$
    \item Jos $p=5, m=2 \implies 5 \ge 2+2$
    \item Jos $p=4, m=3 \implies 4 \not\ge 3+2$ (Ei kelpaa)
  \end{itemize}
Kiinnostavia tapauksia on siis kolmea tyyppiä. Lasketaan niiden lukumäärät ja summataan ne:

\begin{alakohta}
    \item \textbf{5 punaista 26:sta ja 2 mustaa 26:sta:} \\
    \[ N_1 = \binom{26}{5} \cdot \binom{26}{2} = 65780 \cdot 325 = 21378500 \]

    \item \textbf{6 punaista 26:sta ja 1 musta 26:sta:} \\
    \[ N_2 = \binom{26}{6} \cdot \binom{26}{1} = 230230 \cdot 26 = 5985980 \]

    \item \textbf{7 punaista 26:sta:} \\
    \[ N_3 = \binom{26}{7} \cdot \binom{26}{0} = 657800 \cdot 1 = 657800 \]
\end{alakohta}
Kiinnostavia tapauksia on yhteensä $N_{Kiinnostava} = N_1 + N_2 + N_3 = 28022280$\\

Todennäköisyys on:
\[
P = \frac{N_{Kiinnostava}}{\binom{52}{7}} = \frac{28022280}{133784560}
\]
  Pythonilla:
    \begin{verbatim}
      >>> print(28022280 / 133784560)
      0.20945825138566065
    \end{verbatim}

$\Rightarrow  \dfrac{\binom{26}{5}\binom{26}{2} + \binom{26}{6}\binom{26}{1} + \binom{26}{7}}{\binom{52}{7}} \approx 0.21$.






\pagebreak
  \item \textbf{joukossa on neljä samanarvoista korttia?}

  Valitaan ensin jokin kortin arvo (siis, vaikkapa 7), joita on 13 mahdollista.
  Jokaista kortin arvoa kohden on 4 maata $\Rightarrow $ valitsemme kaikki 4 korttia kyseisestä arvosta:
  \[
  \binom{13}{1}
  \]

  Jäljelle jää 3 korttia, jotka valitaan 52-4 = 48 kortin pakasta:
  \[
  \binom{48}{3}
  \]

  Kokonaismäärä:
  \[
  \binom{13}{1} \cdot \binom{48}{3}
  \]

  Ja taas jaetaan kaikilla mahdollisilla:
  \[
  P = \frac{\binom{13}{1} \cdot \binom{48}{3}}{\binom{52}{7}}
  \]

    Pythonilla:
    \begin{verbatim}
      >>> import math
      >>> print(13 * math.comb(48, 3) / math.comb(52, 7))
      0.0016806722689075631
    \end{verbatim}



  Todennäköisyys on \(\dfrac{13 \cdot \binom{48}{3}}{\binom{52}{7}} \approx 0.0017\)
\end{kohta}










\begin{comment}
  
\newpage
\exercise{7}
Laatikossa on 6 mustaa ja 8 valkoista palloa. Mikä on
todennäköisyys, että saadaan vähintään 2 mustaa palloa, kun 
laatikosta nostetaan 7 palloa umpimähkään
\begin{enumerate}
\item[(a)] takaisinpanolla,
\item[(b)] ilman takaisinpanoa?
\end{enumerate}

\begin{kohta}

  \item \textbf{takaisinpanolla,}

  Takaisinpanossa jokaisella nostolla on sama jakauma:
  $P(\text{musta}) = \frac{6}{14}$ ja $P(\text{valkoinen}) = \frac{8}{14}$

  Merkitään X = mustien pallojen lukumäärä
  Tällöin $X \sim \text{Bin}(n=7, p=6/14)$

  Kiinnostaa:
  \[
  P(X \ge 2) = 1 - P(X = 0) - P(X = 1)
  \]

  Lasketaan nämä:
  \[
  P(X = k) = \binom{7}{k} \left(\frac{6}{14}\right)^k \left(\frac{8}{14}\right)^{7-k}
  \]

  \[
  P(X \ge 2) = 1 - \binom{7}{0} \left(\frac{8}{14}\right)^7 - \binom{7}{1} \left(\frac{6}{14}\right)^1 \left(\frac{8}{14}\right)^6
  \]

  \textbf{Vastaus:} \(1 - \left(\frac{8}{14}\right)^7 - 7 \cdot \left(\frac{6}{14}\right)^1 \left(\frac{8}{14}\right)^6\)

  \item \textbf{ilman takaisinpanoa}

  Tämä on \textbf{hypergeometrinen jakauma}.  
  Perusjoukossa on $N = 14$ palloa, joista $K = 6$ on mustia. Nostetaan $n = 7$ palloa ilman takaisinpanoa.  
  Olkoon $X$ = mustien lukumäärä.

  Kiinnostaa:
  \[
  P(X \ge 2) = 1 - P(X = 0) - P(X = 1)
  \]

  Yleinen kaava:
  \[
  P(X = k) = \frac{\binom{6}{k} \binom{8}{7-k}}{\binom{14}{7}}
  \]

  Sijoitetaan:
  \[
  P(X \ge 2) = 1 - \frac{\binom{6}{0} \binom{8}{7}}{\binom{14}{7}} - \frac{\binom{6}{1} \binom{8}{6}}{\binom{14}{7}}
  \]

  \textbf{Vastaus:} \(1 - \dfrac{\binom{6}{0} \binom{8}{7} + \binom{6}{1} \binom{8}{6}}{\binom{14}{7}}\)
\end{kohta}
\end{comment}


\newpage
\exercise{7}
Laatikossa on 6 mustaa ja 8 valkoista palloa. Mikä on
todennäköisyys, että saadaan vähintään 2 mustaa palloa, kun 
laatikosta nostetaan 7 palloa umpimähkään
\begin{enumerate}
\item[(a)] takaisinpanolla,
\item[(b)] ilman takaisinpanoa?
\end{enumerate}

\begin{kohta}

  \item \textbf{takaisinpanolla}

  Jokainen nosto on riippumaton, ja mustan pallon todennäköisyys jokaisella nostolla on
  \[
  P(\text{musta}) = \frac{6}{14}, \quad P(\text{valkoinen}) = \frac{8}{14}
  \]

  Mahdolliset tapaukset joissa ei tule vähintään kahta mustaa on
  \begin{alakohta}
    \item 7 valkoista palloa
    \item yksi musta ja 6 valkoista
  \end{alakohta}

  Lasketaan näiden yhteistodennäköisyys:

  \begin{itemize}
    \item $P(\text{0 mustaa}) = \left(\frac{8}{14}\right)^7$
    \item $P(\text{1 musta}) = \binom{7}{1} \cdot \left(\frac{6}{14}\right)^1 \cdot \left(\frac{8}{14}\right)^6$
  \end{itemize}

  Todennäköisyys saada vähintään kaksi mustaa on
  \[
  P = 1 - \left(\frac{8}{14}\right)^7 - 7 \cdot \left(\frac{6}{14}\right) \cdot \left(\frac{8}{14}\right)^6
  \]

    Pythonilla:
    \begin{verbatim}
      >>> valkoinen = 8 / 14
      >>> musta = 6 / 14
      >>> print(1 - (valkoinen ** 7) - (7 * musta * (valkoinen ** 6)))
      0.8756591944804339
    \end{verbatim}
Eli todennäköisyys saada vähintään kaksi mustaa on $\approx 0.88$




\pagebreak
  \item \textbf{ilman takaisinpanoa}

  Laatikossa on 6 mustaa ja 8 valkoista palloa, eli yhteensä 14.

  Kaikkia mahdollisia 7 pallon nostoja on:
  \[
  \binom{14}{7}
  \]

  Tarkastellaan tilanteita, joissa ei saada vähintään kahta mustaa:

  \begin{alakohta}
    \item 0 mustaa (7 valkoista):
    \[
    \binom{6}{0} \cdot \binom{8}{7}
    \]

    \item 1 musta (ja 6 valkoista):
    \[
    \binom{6}{1} \cdot \binom{8}{6}
    \]
  \end{alakohta}

\vspace{0.8cm}

  Todennäköisyys:
  \[
P = 1 - \frac{\binom{6}{0}\binom{8}{7} + \binom{6}{1}\binom{8}{6}}{\binom{14}{7}}
  \]

    Pythonilla:
    \begin{verbatim}
      >>> import math
      >>> kaikki = math.comb(14, 7)
      >>> _0_mustaa = math.comb(6, 0) * math.comb(8, 7)
      >>> _1_musta = math.comb(6, 1) * math.comb(8, 6)
      >>> suotuisa = kaikki - (_0_mustaa + _1_musta)
      >>> print(suotuisa / kaikki)
      0.9487179487179487
    \end{verbatim}
Eli todennäköisyys saada vähintään kaksi mustaa on $\approx 0.95$

\end{kohta}


\newpage
\exercise{8}
Juniorijalkapallojoukkueessa on 15 pelaajaa.
Avauskokoonpanoon pitää valita 2 hyökkääjää,
3 keskikenttäpelaajaa ja 3 puolustajaa sekä maalivahti.
Loput pelaajat jäävät vaihtopelaajiksi.
Monellako tavalla avauskokoonpano voidaan valita? 


\end{document}