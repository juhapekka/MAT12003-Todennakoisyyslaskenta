\documentclass[12pt,a4paper]{article}
\input{yhteiset-asetukset.tex}

\title{MAT12003 Todennäköisyyslaskenta I — Viikko 4}
\date{}

\begin{document}

\maketitle

\exercise{1}
Heitetään tavallista noppaa ja nostetaan korttipakasta kortti. Olkoon $X$ suurempi nopan silmäluvusta ja kortin arvosta (ässän arvo on 1, jätkän 11, kuningattaren 12 ja kuninkaan 13). Määritä satunnaismuuttujan $X$ odotusarvo.

\vspace{0.4cm}
Olkoon $X=\max(D,K)$, missä
noppa $D\in\{1,\dots,6\}$ ja kortti $K\in\{1,\dots,13\}$.
Heitot on riippumattomat\\


PTNF. Riippumattomuuden vuoksi:
\[
F_X(x)=P(X\le x)=P(D\le x,\;K\le x)=P(D\le x)\,P(K\le x)
\]
jaetaan tapaukset
\[
F_X(x)=
\begin{cases}
\displaystyle \frac{x}{6}\cdot\frac{x}{13}=\frac{x^2}{78} & x=1,2,\dots,6,\\[6pt]
\displaystyle 1\cdot\frac{x}{13}=\frac{x}{13} & x=7,8,\dots,13,
\end{cases}
\quad\text{ja }F_X(0)=0
\]
ptnf saadaan erotuksena:
\[
P(X=x)=F_X(x)-F_X(x-1)=
\begin{cases}
\displaystyle \frac{x^2-(x-1)^2}{78}=\frac{2x-1}{78} & x=1,2,\dots,6\\[8pt]
\displaystyle \frac{x-(x-1)}{13}=\frac{1}{13} & x=7,8,\dots,13
\end{cases}
\]

\textbf{Odotusarvo} 
\[
E(X)=\sum_{x=1}^{13} x\,P(X=x)
=\sum_{x=1}^{6} x\cdot\frac{2x-1}{78}+\sum_{x=7}^{13} x\cdot\frac{1}{13}
\]
Lasketaan summat:
\[
\sum_{x=1}^{6} x(2x-1)=2\sum_{x=1}^{6}x^2-\sum_{x=1}^{6}x
=2\cdot 91-21=161
\]
\[
\sum_{x=7}^{13} x = \frac{(7+13)\cdot 7}{2}=70
\]
Siis
\[
E(X)=\frac{161}{78}+\frac{70}{13}
=\frac{161}{78}+\frac{420}{78}
=\frac{581}{78}\approx 7{,}449
\]

%$F_X(x)=P(\max(D,K)\le x)$ tarkoittaa, että molempien on oltava korkeintaan $x$\\
%Kun $x\le6$, saadaan $P(D\le x)=x/6$ ja $P(K\le x)=x/13$ $\Rightarrow F_X(x)=x^2/78$ \\
%Kun $x\ge7$, noppa on varmasti $\le x$,
%joten $F_X(x)=x/13$ \\
%Pistetodennäköisyys on peräkkäisten $F_X$-arvojen erotus.






\pagebreak
\exercise{2}
Laatikossa on 3 punaista palloa ja 7 sinistä palloa. Laske odotusarvo $E(X)$, kun
\begin{enumerate}
    \item[(a)] $X$ on punaisten pallojen lukumäärä nostettaessa laatikosta 5 palloa ilman takaisinpanoa.
    \item[(b)] $X$ on punaisten pallojen lukumäärä nostettaessa laatikosta 5 palloa takaisinpanolla.
    \item[(c)] $X$ on nostojen lukumäärä, kun laatikosta nostetaan palloja yksi kerrallaan ilman takaisinpanoa, kunnes saadaan sininen pallo.
    \item[(d)] $X$ on nostojen lukumäärä, kun laatikosta nostetaan palloja yksi kerrallaan takaisinpanolla, kunnes saadaan sininen pallo.
\end{enumerate}
\emph{Vihje}: Luentokalvoilla on todistettu odotusarvoja diskreeteille jakaumille, joista on hyötyä useimmissa kohdissa.

\begin{kohta}

\item $X$ on punaisten pallojen lukumäärä nostettaessa laatikosta 5 palloa ilman takaisinpanoa.

Tämä on hypergeometrinen: $X\sim \mathrm{Hyperg}(N{=}10,K{=}3,n{=}5)$\\
Luentomuistiinpanoista: $E(X)=n\cdot \dfrac{K}{N}$
\[
E(X)=5\cdot \frac{3}{10}=\frac{3}{2}=1{,}5
\]

\item $X$ on punaisten pallojen lukumäärä nostettaessa laatikosta 5 palloa takaisinpanolla.

Tää on binomijakauma: $X\sim \mathrm{Bin}(n{=}5,p{=}3/10)$
\[
E(X)=np=5\cdot \frac{3}{10}=\frac{3}{2}=1{,}5
\]

\item $X$ on nostojen lukumäärä, kun laatikosta nostetaan palloja yksi kerrallaan ilman takaisinpanoa, kunnes saadaan sininen pallo.

”Ensimmäisen sinisen” odotettu sijainti negatiivisessa hypergeometrisessä asetelmassa:
\[
E(X)=\frac{N+1}{B+1}
\]
N on kaikkien pallojen määrä, B sinisten määrä. Tässä N=10, B=7, joten
\[
E(X)=\frac{10+1}{7+1}=\frac{11}{8}=1{,}375
\]

\item $X$ on nostojen lukumäärä, kun laatikosta nostetaan palloja yksi kerrallaan takaisinpanolla, kunnes saadaan sininen pallo.

Tää on diskreetti geometrinen jakauma x \in $\{1,2,\dots\}$ ja onnistumistodennäköisyydellä\\
$p=P(\text{sininen})=7/10$\\ Luentomuistiinpanoista: $E(X)=1/p$
\[
E(X)=\frac{1}{7/10}=\frac{10}{7}\approx 1{,}4286
\]

\end{kohta}







\pagebreak
\exercise{3}
Lautta kulkee salmen yli rannalta A rannalle B säännöllisesti 
10 minuutin välein ja sille mahtuu 8 autoa. Oletetaan, että rannalle 
A ei jää yhtään autoa lautan lähtiessä. Oletetaan lisäksi, että seuraavan 
10 minuutin aikana rantaan A saapuvien autojen lukumäärä on 
Poisson-jakautunut satunnaismuuttuja odotusarvolla 5. Millä 
todennäköisyydellä lautta tulee täyteen käydessään seuraavan 
kerran rannalla A? 
\vspace{0.4cm}

Lautta kulkee 10min välein ja ottaa 8 autoa. 
Rannalle A ei jää autoja lautan lähdön hetkellä ja 
seuraavan 10 minuutin aikana saapuvien autojen lukumäärä 
on Poisson-jakautunut odotusarvolla $\lambda=5$
\[
N \sim \mathrm{Poisson}(5),\qquad P(N=k)=e^{-5}\frac{5^k}{k!},\ k=0,1,2,\dots
\]

"Lautta tulee täyteen" seuraavalla käynnillä $\iff$ rannalla odottaa vähintään 8 autoa
\[
P(\text{täyteen})=P(N\ge 8)=1-\sum_{k=0}^{7} e^{-5}\frac{5^k}{k!}.
\]

Numeroarvo:\\
Pythonilla
\begin{verbatim}
    >>> import math
    >>> po = 5
    >>> print(1 - sum(math.exp(-po) * po**k / math.factorial(k) for k in range(8)))
    0.13337167407000727
\end{verbatim}
Eli:
\[
P(N\ge 8)\approx 0{,}13337 \quad (\text{noin }13{,}3\%)
\]









\pagebreak
\exercise{4}
Osoita, että jos $X\sim\operatorname{Geom}(p)$, niin $E(X)=\dfrac{1-p}{p}$. 

\noindent\emph{Vihje}: Derivoi puolittain geometrisen sarjan kaava $\displaystyle\sum_{k=0}^{\infty}x^{k}=\frac{1}{1-x}$, kun $|x|<1$.

\vspace{0.8cm}


\[
P(X=k)=p(1-p)^k,\qquad k=0,1,2,\dots
\]
X on epäonnistumisten lukumäärä ennen ensimmäistä onnistumista\\

Ratkaisu yllä mainitulla vihjeellä:
geometrisen sarjan kaava on
\[
\sum_{k=0}^\infty x^{k}=\frac{1}{1-x}, \text{ kun } |x|<1.
\]
Derivoidaan puolittain
\[
\sum_{k=1}^\infty k\,x^{k-1}=\frac{1}{(1-x)^2}
\quad\Rightarrow\quad
\sum_{k=1}^\infty k\,x^{k}=\frac{x}{(1-x)^2}
\]
Sijoitetaan x=1-p\in(0,1)
\[
\sum_{k=1}^\infty k(1-p)^k=\frac{1-p}{p^2}
\]
Nyt
\[
E(X)=\sum_{k=0}^\infty k\,p(1-p)^k
= p\sum_{k=1}^\infty k(1-p)^k
= p\cdot \frac{1-p}{p^2}
= \frac{1-p}{p}
\]







\pagebreak
\exercise{5}
Olkoon $X$ jatkuva satunnaismuuttuja, jonka tiheysfunktio on 
$$f(x)=\begin{cases}
    \frac{C}{x^{3}},\text{ kun }x\ge a,\\
    0 \text{ muulloin,}
\end{cases}$$
missä $a>0$ on reaalinen parametri ja $C$ on parametrista $a$ riippuva vakio. 
\begin{enumerate}
    \item[(a)] Määritä vakio $C$. 
    \item[(b)] Laske $P(X\ge 2a)$
    \item[(c)] Laske E$(X)$. 
\end{enumerate}

\vspace{0.4cm}

\begin{comment}
    

\end{comment}

\begin{kohta}
  \item \textbf{Määritä vakio $C$.} \\
  Normalisointi todennäköisyydeki $\int_{-\infty}^{\infty} f(x)\,dx=1$ antaa

  \[
    \int_a^\infty \frac{C}{x^{3}}\,dx
    = C\int_a^\infty x^{-3}\,dx
    = C\,\evalslant{-\frac{1}{2x^{2}}}{a}{\infty}
    = C\!\left(0-\Big(-\frac{1}{2a^{2}}\Big)\right)
    = \frac{C}{2a^{2}} = 1
    \;\Rightarrow\; C=2a^{2}
  \]

  \item \textbf{Laske $P(X\ge 2a)$}
  \[
    P(X\ge 2a)
    = \int_{2a}^{\infty} \frac{2a^{2}}{x^{3}}\,dx
    = 2a^{2}\,\evalslant{-\frac{1}{2x^{2}}}{2a}{\infty}
    = 2a^{2}\!\left(0-\Big(-\frac{1}{8a^{2}}\Big)\right)
    = \frac{1}{4}
  \]

  \item \textbf{Laske $E(X)$.}
  \[
    E(X)=\int_{a}^{\infty} x\,f(x)\,dx
    = \int_{a}^{\infty} x\cdot\frac{2a^{2}}{x^{3}}\,dx
    = 2a^{2}\int_{a}^{\infty} x^{-2}\,dx
    = 2a^{2}\,\evalslant{-\frac{1}{x}}{a}{\infty}
    = 2a^{2}\!\left(0-\Big(-\frac{1}{a}\Big)\right)
    = 2a
  \]
\end{kohta}








\pagebreak
\exercise{6}
Tehdas valmistaa tuotetta, jonka kestoaika kulutuksessa
on jakaumaltaan Exp$(\lambda)$, $\lambda >0$. Tehtaan johto voi säädellä
parametria $\lambda$. Mikä $\lambda$:n tulisi olla, jotta todennäköisyys, että
kestoaika olisi korkeintaan 3 vuotta, olisi vähintään $0{,}5$?\\


Eksponenttijakauman kertymäfunktio (Määritelmä 5.9)
\[
F_T(t)=P(T\le t)=1-e^{-\lambda t}\quad \mid(t\ge 0)
\]
$P(T\le 3)\ge 0{,}5$ antaa
\[
1-e^{-3\lambda}\ \ge\ \tfrac12
\ \Longleftrightarrow\
e^{-3\lambda}\ \le\ \tfrac12
\ \Longleftrightarrow\
-3\lambda\ \le\ \ln\tfrac12
\ \Longleftrightarrow\
\lambda\ \ge\ \frac{\ln 2}{3}
\]

Pythonilla:
\begin{verbatim}
    >>> import math
    >>> print(math.log(2)/3)
    0.23104906018664842
\end{verbatim}

Eli riittää valita 
\[
\lambda \ge \dfrac{\ln 2}{3}\ \approx 0{,}231
\]







\pagebreak
\exercise{7}
Tieosuudella, jossa oli nopeusrajoitus 100 km/h, tutkittiin autojen keskinopeuksia. Tutkimuksen perusteella kyseisellä tieosuudella autojen keskinopeuden odotusarvo oli 97 km/h ja keskihajonta 6 km/h. Oletetaan, että autojen keskinopeus oli normaalijakautunut.
\begin{enumerate}
\item[(a)] Millä todennäköisyydellä satunnaisesti valitun auton keskinopeus oli vähintään 90 km/h, mutta alle 100 km/h?
\item[(b)] Millä todennäköisyydellä satunnaisesti valitun auton keskinopeus oli yli 110 km/h?
\item[(c)] Mikä on 200 auton otoksessa olevien yli 110 km/h keskinopeudella ajavien autojen lukumäärän odotusarvo?
\end{enumerate}
\vspace{0.8cm}


Esimerkkiä 5.14 mukaillen:
\vspace{0.2cm}

Tieosuudella autojen keskinopeus 
$X\sim N(\mu=97,\ \sigma=6)$ km/h\\

$Z=\dfrac{X-\mu}{\sigma}\sim N(0,1)$, merkitään $\Phi$ standardinormaalin kertymäfunktiota

\begin{kohta}
  \item $P(90\le X<100)$

  \[
  P(90\le X<100)=\Phi\!\Big(\frac{100-97}{6}\Big)-\Phi\!\Big(\frac{90-97}{6}\Big)
  =\Phi(0.5)-\Phi(-7/6)
  \]
  Koska $\Phi(-a)=1-\Phi(a)$
  \[
  =\Phi(0.5)+\Phi(7/6)-1 \approx 0{,}69146+0{,}87833-1
  = 0{,}56979
  \]

  \item $P(X>110)$

  \[
  P(X>110)=1-\Phi\!\Big(\frac{110-97}{6}\Big)=1-\Phi\!\Big(\frac{13}{6}\Big)
  \approx 1-\Phi(2{,}1667)=0{,}01513
  \]

  \item Yli 110 km/h ajavien odotettu lukumäärä 200 auton otoksessa:

  Jos I=$1_{\{X>110\}}$, niin E(I)=P(X>110) ja
  \[
  E(\text{lukumäärä})=200\cdot P(X>110)\approx 200\cdot 0{,}01513
  = 3{,}03
  \]
\end{kohta}









\pagebreak
\exercise{8}
Oletetaan, että $X\sim\operatorname{Tas}(0,1)$.
Johda satunnaismuuttujan $e^X$ tiheys- ja kertymäfunktiot ja laske $E(e^X)$.

\noindent\emph{Vihje}: Aloita kertymäfunktiosta.
\vspace{0.8cm}


$X\sim\mathrm{Tas}(0,1)$ ja asetetaan $Y=e^X$\\

\textbf{Kertymäfunktio}\\
Koska $e^x$ on aidosti kasvava ja $X\in[0,1]$, saadaan $Y\in(1,e)$ ($e^0=1$ ja $e^1=e$):
\[
F_Y(y)=P(Y\le y)=P(e^X\le y)=P\!\big(X\le \ln y\big)=
\begin{cases}
0 & y\le 1\\[2pt]
\ln y & 1<y<e\\[2pt]
1 & y\ge e
\end{cases}
\]

\textbf{Tiheysfunktio}\\
Derivoidaan $F_Y$:
\[
f_Y(y)=F_Y'(y)=
\begin{cases}
\dfrac{1}{y} & 1<y<e\\[6pt]
0 & \text{muulloin}
\end{cases}
\]

\textbf{Odotusarvo}\\
\[
E(e^X)=E(Y)=\int_{0}^{1} e^x\,dx
= \evalslant{e^x}{0}{1}
=e-1
\]

\textbf{Eli}\\
\[
F_Y(y)=
\begin{cases}
0& y\le 1\\
\ln y& 1<y<e\\
1& y\ge e
\end{cases}
\qquad
f_Y(y)=
\begin{cases}
\dfrac{1}{y}& 1<y<e\\
0& \text{muulloin}
\end{cases}
\qquad
E(e^X)=e-1
\]






\pagebreak

\exercise{9}
Herra K matkustaa bussilla. Bussin saapumisaika lähtöpysäkille
on satunnaismuuttuja $X$, joka on tasaisesti jakautunut välillä $(0,5)$
minuuttia. (Huomaa, että kyseessä on jatkuva jakauma, saapumisaika voi siis 
olla mikä tahansa reaaliluku tällä välillä.) Sen jälkeen bussimatka kestää
ajan $Y$, joka on tasaisesti jakautunut välillä $(10,16)$ minuuttia. Perillä
ollaan siis hetkellä $X+Y$. Herra K:n pitäisi olla töissä viimeistään hetkellä
20. Kurssisivulta löytyvä R-koodi \texttt{bussisimu.r} simuloi kymmenen kertaa 
herra K:n matkaa ja töihin ehtimistä. Kokeile koodia, kun olet ensin ladannut 
sen omalle koneellesi.

Muokkaa koodia seuraavasti:
\begin{enumerate}
\item[(1)] Bussimatkan kesto onkin tasaisesti jakautunut välillä $(10,20+k)$,
missä $k$ on opiskelijanumerosi viimeinen numero (jos esim.\ opiskelijanumerosi
on 012345678, niin $k=8$. Älä kirjoita opiskelijanumeroasi näkyviin ratkaisuusi!)
\item[(2)] Bussimatkoja simuloidaankin 10\,000 eikä kymmenen kertaa. Suorita 
simulaatio ja raportoi vastauksessasi, miten usein herra K ehtii töihin
(ts.\ simulaatioon perustuva arvio sille, että hän ehtii töihin).
\end{enumerate}




\textbf{Simulaatio R:llä (\(n=10000\)):}
{\small
\begin{verbatim}
    n <- 10000  # Simuloitujen matkojen lukumäärä
    k <- 2  # Opiskelijanumeroni viimeinen numero

    # Simuloidaan n bussimatkaa
    x <- runif(n, 0, 5)  # Arvotaan tasajakaumasta
    y <- runif(n, 10, 20 + k)  # Arvotaan tasajakaumasta
    s <- x + y  # Saapumisaika

    # Tutkitaan, millä kerroilla herra K ehti töihin
    ehti <- (s <= 20)
    ehti_lkm <- sum(ehti)
    ehti_osuus <- ehti_lkm / n
    ehti_osuus

    print(ehti_osuus)
\end{verbatim}
}

\textbf{R for Mac OS:}
\begin{verbatim}
    > source("~/Downloads/bussisimu.r")
    [1] 0.6189
\end{verbatim}
Eli simulaation mukaan Herra K ehtii töihin 62\% todennäköisyydellä.

\end{document}
